<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="//sdk.amazonaws.com/js/aws-sdk-2.1.34.min.js"></script>
<script src="Three_r48.js"></script>
<script src="cannon.js"></script>
<script src="STLLoader.js"></script>

<input type="file" name="upload" id="upload-file">
<a href="javascript:void(0)" id="apply-upload">アップロード</a>

<script>
$(function() {
  var s3_client = function() {
    AWS.config.region = "ap-northeast-1";
    AWS.config.credentials = new AWS.CognitoIdentityCredentials({IdentityPoolId: "ap-northeast-1:ca83a9df-7fe6-4166-b587-62eb02ddc388"});
    AWS.config.credentials.get(function(err) {
        if (!err) {
            console.log("Cognito Identify Id: " + AWS.config.credentials.identityId);
        }
    });
    return new AWS.S3({params: {Bucket: "smart-3d"}});
  };
  $("#apply-upload").click(function() {
    var file = $("#upload-file").prop("files")[0];
    var timestamp = new Date().getTime();
    var filename = "file" + timestamp + ".jpg";
    s3_client().putObject({Key: "row-image/" + filename, ContentType: file.type, Body: file, ACL: "public-read"},
    function(err, data){
      // if failed, alert
      if(data !== null){
        alert("アップロード成功!");
      } else {
        alert("アップロード失敗.");
      }
    });
  });

};
});
></script>
